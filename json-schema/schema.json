{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raw.githubusercontent.com/FAIRiCUBE/fairicube/refs/heads/main/json-schema/schema.json#",
  "title": "FAIRiCUBE Extension",
  "description": "STAC FAIRiCUBE Extension for STAC Items.",
  "type": "object",
  "required": [
    "stac_extensions"
  ],
  "properties": {
    "stac_extensions": {
      "type": "array",
      "contains": {
        "const": "https://raw.githubusercontent.com/FAIRiCUBE/fairicube/refs/heads/main/json-schema/schema.json"
      }
    }
  },
  "oneOf": [
    {
      "$comment": "This is the schema for STAC Items. Remove this object if this extension only applies to Collections.",
      "type": "object",
      "required": [
        "type",
        "properties"
      ],
      "properties": {
        "type": {
          "const": "Feature"
        }

      },
      "anyOf": [
            {
              "properties": {
                "properties": {
                  "$ref": "#/definitions/fields"
                }
              }
            },
            {
              "$ref": "#/definitions/require_properties"
            },
            {
              "$ref": "#/definitions/require_assets"
            }
          ]
    }
  ],
  "definitions": {
    "require_properties": {
        "anyOf": [
          {
            "$ref": "#/definitions/require_fields"
          },
          {
            "$ref": "#/definitions/require_in_bands"
          }
        ]
      },
      "require_assets": {
        "required": ["assets"],
        "properties": {
          "assets": {
            "$ref": "#/definitions/asset_contains"
          }
        }
      },
    "fields": {
      "type": "object",
      "properties": {
        "fairicube:use_case": {
          "$ref": "#/definitions/fairicube:use_case"
        },
        "fairicube:quality_measures": {
          "$ref": "#/definitions/fairicube:quality_measures"
        }
      },
      "patternProperties": {
        "^(?!fairicube:)": {}
      },
      "additionalProperties": false
    },
    "asset_contains": {
        "type": "object",
        "not": {
          "additionalProperties": {
            "not": {
              "$ref": "#/definitions/require_properties"
            }
          }
        }
      },
    "require_in_bands": {
        "required": ["bands"],
        "properties": {
          "bands": {
            "type": "array",
            "contains": {
              "$ref": "#/definitions/require_fields"
            }
          }
        }
      },
      "require_fields": {
        "anyOf": [
          { "required": ["fairicube:definition"] },
          { "required": ["fairicube:comment"] },
          { "required": ["fairicube:interpolation"] }
        ]
      },
    "fairicube:use_case": {
      "type": "string",
      "minLength": 1
    },
    "fairicube:quality_measures": {
      "type": "string",
      "minLength": 1
    },
    "fairicube:definition": {
      "type": "string",
      "minLength": 1
    },
    "fairicube:comment": {
      "type": "string",
      "minLength": 1
    },
    "fairicube:interpolation": {
      "type": "string",
      "minLength": 1
    },
    "json_schema": {
      "$comment": "JSON Schema",
      "type": "object"
    }
  }
}